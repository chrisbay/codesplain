machine:
  node:
    version: 7.7.2

checkout:
  post:
    - git submodule sync --recursive
    - git submodule update --recursive --init

dependencies:
  override:
    - yarn

test:
  override:
    - yarn test-circle

deployment:
  release:
    tag: /v[0-9]+(\.[0-9]+)*/
    commands:
        - ./publish release $CIRCLE_TAG
  master:
    branch: master
    commands:
      - ./publish dev
